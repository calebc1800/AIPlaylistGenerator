
<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playlist Preview</title>
    <link rel="stylesheet" href="{% static 'recommender.css' %}"/>
    <style>
        /* Remix Modal Styles */
        .remix-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(10, 10, 10, 0.92);
            backdrop-filter: blur(12px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 90;
        }

        .remix-modal-overlay.hidden {
            display: none;
        }

        .remix-modal {
            background: linear-gradient(135deg, rgba(2, 136, 209, 0.18), rgba(66, 165, 245, 0.1));
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.12);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.45);
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideIn 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .remix-modal__header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 24px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .remix-modal__header h2 {
            margin: 0;
            font-size: 1.35rem;
            font-weight: 700;
            color: #ffffff;
        }

        .remix-modal__close {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: rgba(255, 255, 255, 0.6);
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.2s ease;
        }

        .remix-modal__close:hover {
            color: rgba(255, 255, 255, 0.9);
        }

        .remix-modal__body {
            padding: 24px;
        }

        .remix-form-group {
            margin-bottom: 20px;
        }

        .remix-form-group:last-child {
            margin-bottom: 0;
        }

        .remix-form-label {
            display: block;
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 8px;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .remix-form-input {
            width: 100%;
            padding: 10px 12px;
            font-size: 14px;
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.04);
            color: #ffffff;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
            box-sizing: border-box;
        }

        .remix-form-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .remix-form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        .remix-form-input:focus {
            outline: none;
            border-color: rgba(66, 165, 245, 0.6);
            box-shadow: 0 0 0 3px rgba(66, 165, 245, 0.25);
        }

        .remix-modal__footer {
            display: flex;
            gap: 12px;
            padding: 24px;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            justify-content: flex-end;
        }

        .remix-modal__footer .btn {
            min-width: 120px;
        }

    </style>

</head>
<body>
    <div class="page-container">
        <header>
            <div class="header-inner">
                <a href="{% url 'dashboard:dashboard' %}" class="logo">AI Playlist Generator</a>
                <div class="track-count"><span id="track-count">{{ playlist_tracks|length }}</span> Tracks</div>
            </div>
        </header>
        <main>
            <div class="message-stack" id="message-stack">
                {% for message in messages %}
                    <div class="message message-{{ message.tags }}">{{ message }}</div>
                {% endfor %}
                {% for item in errors %}
                    <div class="message message-warning">{{ item }}</div>
                {% endfor %}
            </div>

            <section class="playlist-hero">
                <form id="playlist-save-form" class="playlist-form" method="post" action="{% url 'recommender:save_playlist' %}">
                    {% csrf_token %}
                    <input type="hidden" name="cache_key" value="{{ cache_key }}">
                    {% if prompt %}
                        <input type="hidden" name="prompt" value="{{ prompt }}">
                    {% endif %}
                    <div class="playlist-hero__grid">
                        <div class="playlist-hero__primary">
                            <p class="eyebrow-label">Your AI-powered mix</p>
                            {% with current_name=playlist_name|default:suggested_playlist_name %}
                                <input
                                    type="text"
                                    name="playlist_name"
                                    id="playlist-name-input"
                                    class="playlist-name-input"
                                    maxlength="100"
                                    placeholder="Name your playlist"
                                    value="{{ current_name }}">
                            {% endwith %}
                            <div class="prompt-pill">
                                <span class="prompt-pill__label">Prompt</span>
                                <span class="prompt-pill__value">{{ prompt|default:"Custom AI blend" }}</span>
                            </div>
                            <div class="hero-meta">
                                <div class="hero-chip">
                                    <span class="hero-chip__label">Tracks</span>
                                    <span class="hero-chip__value">{{ playlist_tracks|length }}</span>
                                </div>
                                {% if playlist_stats %}
                                    <div class="hero-chip">
                                        <span class="hero-chip__label">Duration</span>
                                        <span class="hero-chip__value">{{ playlist_stats.total_duration }}</span>
                                    </div>
                                    {% if playlist_stats.novelty %}
                                        <div class="hero-chip">
                                            <span class="hero-chip__label">New discoveries</span>
                                            <span class="hero-chip__value">{{ playlist_stats.novelty }}%</span>
                                        </div>
                                    {% endif %}
                                {% endif %}
                            </div>
                        </div>
                        <div class="playlist-hero__actions">
                            <div class="action-buttons">
                                <button
                                    type="button"
                                    class="btn btn-ghost"
                                    id="remix-button"
                                    {% if not cache_key or not playlist_tracks %}disabled{% endif %}>
                                    Remix Playlist
                                </button>
                                <button type="submit" class="btn btn-primary" id="save-playlist-button">
                                    Save to Spotify
                                </button>
                            </div>
                            <p class="hero-tip">
                                Need a different direction? Update the prompt above or search for specific tracks.
                            </p>
                            <a href="{% url 'create' %}" class="hero-link">Start a new idea →</a>
                        </div>
                    </div>
                </form>
            </section>

            <section class="search-card">
                <div class="search-card__header">
                    <h3>Add more songs</h3>
                    <p>Blend in any must-have tracks or artists before saving to Spotify.</p>
                </div>
                <div class="search-bar">
                    <input
                        type="text"
                        id="song-search-input"
                        class="search-input"
                        placeholder="Search for tracks or artists..."
                        data-search-url="{% url 'recommender:search_songs' %}"
                        data-add-url="{% url 'recommender:add_song_to_playlist' %}"
                        data-cache-key="{{ cache_key }}">
                    <button type="button" class="search-trigger" id="song-search-trigger">Search</button>
                    <div id="search-results" class="search-results" style="display: none;"></div>
                </div>
            </section>

            {% if playlist_stats and playlist_stats.genre_top %}
                <section class="inspiration-panel">
                    <div class="inspiration-header">
                        <h3>Signature Sounds</h3>
                        <p>Top genres fueling this playlist.</p>
                    </div>
                    <div class="chip-group">
                        {% for genre in playlist_stats.genre_top|slice:":4" %}
                            <span class="genre-chip">
                                <span class="genre-chip__label">{{ genre.genre }}</span>
                                <span class="genre-chip__value">{{ genre.percentage }}%</span>
                            </span>
                        {% endfor %}
                    </div>
                </section>
            {% endif %}

            {% if prompt_artist_candidates %}
                <section class="inspiration-panel subtle">
                    <div class="inspiration-header">
                        <h3>Referenced Artists</h3>
                        <p>Based on your prompt. Tap a name to search for more tracks.</p>
                    </div>
                    <div class="chip-group chip-group--interactive">
                        {% for artist in prompt_artist_candidates %}
                            <button
                                type="button"
                                class="chip-button"
                                data-search-term="{{ artist }}"
                                data-target-input="song-search-input">
                                {{ artist }}
                            </button>
                        {% endfor %}
                    </div>
                </section>
            {% endif %}

            {% if playlist_stats and playlist_stats.top_popular_tracks %}
                <section class="spotlight-panel">
                    <div class="spotlight-header">
                        <div>
                            <h3>Spotlight Recommendations</h3>
                            <p>Standout picks from this mix — perfect for sharing.</p>
                        </div>
                    </div>
                    <div class="spotlight-grid">
                        {% for track in playlist_stats.top_popular_tracks|slice:":3" %}
                            <article class="spotlight-card">
                                <div class="spotlight-rank">#{{ forloop.counter }}</div>
                                <div class="spotlight-track">
                                    {% if track.album_image_url %}
                                        <img src="{{ track.album_image_url }}" alt="" class="spotlight-art">
                                    {% endif %}
                                    <div>
                                        <p class="spotlight-name">{{ track.name }}</p>
                                        <p class="spotlight-artist">{{ track.artists }}</p>
                                    </div>
                                </div>
                                <div class="spotlight-meta">
                                    <span class="spotlight-label">Energy</span>
                                    <span class="spotlight-value">{{ track.popularity }}</span>
                                </div>
                            </article>
                        {% endfor %}
                    </div>
                </section>
            {% endif %}

            {% if playlist_stats %}
                <section class="playlist-stats elevated" data-has-stats>
                    <div class="playlist-stats__intro">
                        <div>
                            <h3 class="playlist-stats__title">Playlist Insights</h3>
                            <p class="playlist-stats__tagline">
                                A quick snapshot of the vibe you just generated.
                            </p>
                        </div>
                        <div class="playlist-stats__totals">
                            <span class="analytics-chip">
                                <span class="analytics-chip__value">{{ playlist_stats.total_tracks }}</span>
                                <span class="analytics-chip__label">Tracks</span>
                            </span>
                            <span class="analytics-chip">
                                <span class="analytics-chip__value">{{ playlist_stats.total_duration }}</span>
                                <span class="analytics-chip__label">Duration</span>
                            </span>
                        </div>
                        <button type="button" class="genre-toggle" aria-expanded="false">
                            Show All Genres
                        </button>
                    </div>

                    <div class="playlist-stats__grid">
                        <article class="analytics-card analytics-card--overview">
                                <h4 class="analytics-card__title">Quick Stats</h4>
                                <div class="analytics-overview">
                                    <div class="overview-row">
                                        <span class="overview-label">Average Popularity</span>
                                        <span class="overview-value">
                                            {% if playlist_stats.avg_popularity is not None %}
                                                {{ playlist_stats.avg_popularity }}
                                            {% else %}
                                                —
                                            {% endif %}
                                        </span>
                                    </div>
                                    <div class="overview-row">
                                        <span class="overview-label">Fresh Finds</span>
                                        <span class="overview-value">{{ playlist_stats.novelty }}%</span>
                                    </div>
                                </div>
                                <p class="analytics-card__note">
                                    Based on your latest AI-generated mix.
                                </p>
                            </article>

                            <article class="analytics-card analytics-card--genre">
                                <div class="analytics-card__header">
                                    <h4 class="analytics-card__title">Genre Blend</h4>
                                    <span class="stat-caption">Breakdown of dominant styles</span>
                                </div>
                                <div class="analytics-chart analytics-chart--genre">
                                    <canvas id="genre-distribution-chart" data-chart="genre"></canvas>
                                </div>
                                <div class="genre-lists">
                                    <div>
                                        <h5>Top Genres</h5>
                                        <ul class="genre-legend" data-genre-list="top">
                                            {% for item in playlist_stats.genre_top %}
                                                <li data-genre="{{ item.genre|default:'' }}">
                                                    <span class="genre-label">{{ item.genre|default:"—" }}</span>
                                                    <span class="genre-value">{{ item.percentage|default:0 }}%</span>
                                                </li>
                                            {% empty %}
                                                <li class="genre-empty" data-genre>
                                                    Waiting on genre data – remix to analyze fresh tracks.
                                                </li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                    {% if playlist_stats.genre_remaining %}
                                        <div>
                                            <h5>More to Explore</h5>
                                            <ul class="genre-legend genre-legend--hidden" data-genre-list="remaining">
                                                {% for item in playlist_stats.genre_remaining %}
                                                    <li data-genre="{{ item.genre|default:'' }}">
                                                        <span class="genre-label">{{ item.genre|default:"—" }}</span>
                                                        <span class="genre-value">{{ item.percentage|default:0 }}%</span>
                                                    </li>
                                                {% endfor %}
                                            </ul>
                                        </div>
                                    {% endif %}
                                </div>
                            </article>

                            <article class="analytics-card analytics-card--meter">
                                <h4 class="analytics-card__title">Average Popularity</h4>
                                <div class="analytics-meter">
                                    <div class="stat-value--meter">
                                        <span class="stat-value">
                                            {% if playlist_stats.avg_popularity is not None %}
                                                {{ playlist_stats.avg_popularity }}
                                            {% else %}
                                                —
                                            {% endif %}
                                        </span>
                                        <div class="stat-meter">
                                            <div
                                                class="stat-meter__fill"
                                                style="width: {{ playlist_stats.avg_popularity|default:0 }}%;"
                                                aria-hidden="true"></div>
                                        </div>
                                    </div>
                                </div>
                                <p class="analytics-card__note">Spotify popularity score (0-100).</p>
                            </article>

                            <article class="analytics-card analytics-card--popularity">
                                <div class="analytics-card__header">
                                    <h4 class="analytics-card__title">Popularity Highlights</h4>
                                    <span class="stat-caption">Where the crowd favorites sit</span>
                                </div>
                                <div class="popularity-columns">
                                    <div class="popularity-column">
                                        <h5 class="popularity-heading">Most Popular</h5>
                                        <ul class="analytics-list">
                                            {% for track in playlist_stats.top_popular_tracks %}
                                                <li class="analytics-list__item">
                                                    <div class="list-track">
                                                        {% if track.album_image_url %}
                                                            <img src="{{ track.album_image_url }}" alt="Album art for {{ track.name|default:'Unknown Track' }}" class="list-track__art">
                                                        {% else %}
                                                            <div class="list-track__art list-track__art--placeholder">
                                                                {{ track.name|default:"?"|slice:":1" }}
                                                            </div>
                                                        {% endif %}
                                                        <div class="list-track__meta">
                                                            <span class="list-track__name">{{ track.name|default:"Unknown Track" }}</span>
                                                            <span class="list-track__artists">{{ track.artists|default:"Unknown Artist" }}</span>
                                                        </div>
                                                        <span class="list-track__score">{{ track.popularity }}</span>
                                                    </div>
                                                </li>
                                            {% empty %}
                                                <li class="analytics-list__item analytics-list__item--empty">
                                                    Need a few tracks with popularity data to surface highlights.
                                                </li>
                                            {% endfor %}
                                        </ul>
                                    </div>

                                    <div class="popularity-column">
                                        <h5 class="popularity-heading">Least Popular</h5>
                                        <ul class="analytics-list">
                                            {% for track in playlist_stats.least_popular_tracks %}
                                                <li class="analytics-list__item">
                                                    <div class="list-track">
                                                        {% if track.album_image_url %}
                                                            <img src="{{ track.album_image_url }}" alt="Album art for {{ track.name|default:'Unknown Track' }}" class="list-track__art">
                                                        {% else %}
                                                            <div class="list-track__art list-track__art--placeholder">
                                                                {{ track.name|default:"?"|slice:":1" }}
                                                            </div>
                                                        {% endif %}
                                                        <div class="list-track__meta">
                                                            <span class="list-track__name">{{ track.name|default:"Unknown Track" }}</span>
                                                            <span class="list-track__artists">{{ track.artists|default:"Unknown Artist" }}</span>
                                                        </div>
                                                        <span class="list-track__score">{{ track.popularity }}</span>
                                                    </div>
                                                </li>
                                            {% empty %}
                                                <li class="analytics-list__item analytics-list__item--empty">
                                                    Need a few tracks with popularity data to surface highlights.
                                                </li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </div>
                            </article>

                            {% if playlist_stats.source_mix %}
                                <article class="analytics-card">
                                    <div class="analytics-card__header">
                                        <h4 class="analytics-card__title">Source Blend</h4>
                                        <span class="stat-caption">Track origins across AI and personal data</span>
                                    </div>
                                    <div class="analytics-chart">
                                        <canvas id="source-mix-chart" data-chart="source"></canvas>
                                    </div>
                                    <ul class="analytics-list">
                                        {% for item in playlist_stats.source_mix %}
                                            <li class="analytics-list__item">
                                                <div class="list-track">
                                                    <div class="list-track__meta">
                                                        <span class="list-track__name">{{ item.label }}</span>
                                                        <span class="list-track__artists">{{ item.count }} tracks</span>
                                                    </div>
                                                    <span class="list-track__score">{{ item.percentage }}%</span>
                                                </div>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </article>
                            {% endif %}

                            <article class="analytics-card analytics-card--novelty">
                                <div class="analytics-card__header">
                                    <h4 class="analytics-card__title">Freshness Gauge</h4>
                                    <span class="stat-caption">Shows how much of the playlist is new to you</span>
                                </div>
                                <div class="analytics-chart analytics-chart--doughnut">
                                    <canvas id="novelty-doughnut-chart" data-chart="novelty"></canvas>
                                    <div class="chart-center">
                                        <span class="detail-value">{{ playlist_stats.novelty }}%</span>
                                        <span class="detail-label">New discoveries</span>
                                    </div>
                                </div>
                            </article>

                        </div>

                        {{ playlist_stats|json_script:"playlist-stats-data" }}
                </section>
            {% endif %}

            <section class="track-stack">
                <div class="track-stack__header">
                    <div>
                        <h3>Your playlist</h3>
                        <p>Edit, reorder, or remove tracks before saving.</p>
                    </div>
                </div>
                <ul
                    class="track-list"
                    id="track-list"
                    data-cache-key="{{ cache_key }}"
                    data-update-url="{% url 'recommender:update_cached_playlist' %}">
                    {% for track in playlist_tracks %}
                        <li
                            class="track-item"
                            data-track-id="{{ track.id }}"
                            data-position="{{ forloop.counter0 }}">
                            <div class="track-position">#{{ forloop.counter }}</div>
                            <div class="track-artwork">
                                {% if track.album_image_url %}
                                    <img src="{{ track.album_image_url }}" alt="Album artwork for {{ track.name }}">
                                {% else %}
                                    {{ track.name|default:"?"|slice:":1" }}
                                {% endif %}
                            </div>
                            <div class="track-info">
                                <span class="track-name">{{ track.name }}</span>
                                <span class="track-artist">{{ track.artists }}</span>
                                {% if track.album_name %}
                                    <span class="track-album">{{ track.album_name }}</span>
                                {% endif %}
                            </div>
                            <div class="track-meta">
                                <span
                                    class="track-duration"
                                    data-duration-ms="{{ track.duration_ms|default:0 }}">--:--</span>
                                <button
                                    type="button"
                                    class="remove-track-button">
                                    Remove
                                </button>
                            </div>
                        </li>
                    {% empty %}
                        <li class="empty-state" id="empty-state">
                            No tracks available yet. Use Remix to generate a new set.
                        </li>
                    {% endfor %}
                </ul>
            </section>


            {% if debug_enabled %}
                <section class="debug-panel">
                    <h3>Debug Inspector</h3>

                    <div class="debug-meta">
                        <div class="debug-meta-row">
                            <span class="debug-meta-label">Prompt</span>
                            <span class="debug-meta-value">{{ prompt|default:"—" }}</span>
                        </div>
                        {% if attributes %}
                            <div class="debug-meta-row">
                                <span class="debug-meta-label">Attributes</span>
                                <span class="debug-meta-value">
                                    {% for key, value in attributes.items %}
                                        <span class="debug-chip">{{ key }}: {{ value|default:"—" }}</span>
                                    {% empty %}
                                        <span class="debug-meta-value">—</span>
                                    {% endfor %}
                                </span>
                            </div>
                        {% endif %}
                        {% if seed_source_counts %}
                            <div class="debug-meta-row">
                                <span class="debug-meta-label">Seed Sources</span>
                                <span class="debug-meta-value">
                                    {% for source, count in seed_source_counts.items %}
                                        <span class="debug-chip">{{ source }}: {{ count }}</span>
                                    {% endfor %}
                                </span>
                            </div>
                        {% endif %}
                        {% if prompt_artist_candidates %}
                            <div class="debug-meta-row">
                                <span class="debug-meta-label">Prompt Artists</span>
                                <span class="debug-meta-value">{{ prompt_artist_candidates|join:", " }}</span>
                            </div>
                        {% endif %}
                        {% if llm_provider %}
                            <div class="debug-meta-row">
                                <span class="debug-meta-label">LLM Provider</span>
                                <span class="debug-meta-value">{{ llm_provider|capfirst }}</span>
                            </div>
                        {% endif %}
                    </div>

                    <details class="debug-details" open>
                        <summary>Seed Inventory ({{ seed_track_details|length }})</summary>
                        {% if seed_track_details %}
                            <table class="debug-table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Track</th>
                                        <th>Artists</th>
                                        <th>Source</th>
                                        <th>Year</th>
                                        <th>Popularity</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for track in seed_track_details %}
                                        <tr>
                                            <td>{{ forloop.counter }}</td>
                                            <td>
                                                <div>{{ track.name|default:"(unknown track)" }}</div>
                                                {% if track.id %}
                                                    <div class="debug-track-meta">ID: {{ track.id }}</div>
                                                {% endif %}
                                            </td>
                                            <td>{{ track.artists|default:"—" }}</td>
                                            <td>{{ track.seed_source|default:track.source|default:"—" }}</td>
                                            <td>{{ track.year|default:"—" }}</td>
                                            <td>{{ track.popularity|default:"—" }}</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        {% else %}
                            <p class="debug-empty">No seed tracks recorded.</p>
                        {% endif %}
                    </details>

                    <details class="debug-details" open>
                        <summary>Similarity Scores ({{ similar_track_details|length }})</summary>
                        {% if similar_track_details %}
                            <table class="debug-table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Track</th>
                                        <th>Artists</th>
                                        <th>Score</th>
                                        <th>Breakdown</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for track in similar_track_details %}
                                        <tr>
                                            <td>{{ forloop.counter }}</td>
                                            <td>
                                                <div>{{ track.name|default:"(unknown track)" }}</div>
                                                {% if track.id %}
                                                    <div class="debug-track-meta">ID: {{ track.id }}</div>
                                                {% endif %}
                                            </td>
                                            <td>{{ track.artists|default:"—" }}</td>
                                            <td>
                                                <div class="score-cell">
                                                    <span class="score-badge">{{ track.score|default:0|floatformat:3 }}</span>
                                                    {% if track.popularity %}
                                                        <span class="flag-chip popularity">Pop {{ track.popularity }}</span>
                                                    {% endif %}
                                                    {% if track.seed_artist_overlap %}
                                                        <span class="flag-chip seed">Seed overlap</span>
                                                    {% endif %}
                                                    {% if track.focus_artist_overlap %}
                                                        <span class="flag-chip focus">Focus artist</span>
                                                    {% endif %}
                                                </div>
                                            </td>
                                            <td>
                                                {% if track.score_breakdown %}
                                                    <div class="breakdown-list">
                                                        {% for key, value in track.score_breakdown.items %}
                                                            {% if key != 'total' and value %}
                                                                <span class="breakdown-pill">{{ key }}: {{ value|floatformat:3 }}</span>
                                                            {% endif %}
                                                        {% endfor %}
                                                        {% if track.score_breakdown.total %}
                                                            <span class="breakdown-pill breakdown-total">total: {{ track.score_breakdown.total|floatformat:3 }}</span>
                                                        {% endif %}
                                                    </div>
                                                {% else %}
                                                    <span class="debug-empty">No breakdown recorded.</span>
                                                {% endif %}
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        {% else %}
                            <p class="debug-empty">No similarity candidates were ranked.</p>
                        {% endif %}
                    </details>

                    {% if profile_snapshot %}
                        <details class="debug-details">
                            <summary>User Profile Cache Snapshot ({{ profile_snapshot.sample_size|default:0 }} tracks)</summary>
                            <div class="debug-meta">
                                <div class="debug-meta-row">
                                    <span class="debug-meta-label">Source</span>
                                    <span class="debug-meta-value">{{ profile_snapshot.source|default:"—" }}</span>
                                </div>
                                <div class="debug-meta-row">
                                    <span class="debug-meta-label">Captured</span>
                                    <span class="debug-meta-value">{{ profile_snapshot.created_at|default:"—" }}</span>
                                </div>
                            </div>

                            {% if profile_snapshot.top_tracks %}
                                <h4 style="margin-top: 12px; font-size: 0.95rem; color: rgba(255, 255, 255, 0.85);">Top Cached Tracks</h4>
                                <ul class="debug-list">
                                    {% for track in profile_snapshot.top_tracks %}
                                        <li>{{ track.name|default:"(unknown)" }} — {{ track.artists|default:"—" }} (pop {{ track.popularity|default:0 }}, {{ track.year|default:"—" }})</li>
                                    {% endfor %}
                                </ul>
                            {% endif %}

                            {% if profile_snapshot.top_artists %}
                                <h4 style="margin-top: 16px; font-size: 0.95rem; color: rgba(255, 255, 255, 0.85);">Top Artists by Play Count</h4>
                                <ul class="debug-list">
                                    {% for artist in profile_snapshot.top_artists %}
                                        <li>{{ artist.name|default:artist.id }} — {{ artist.play_count|default:0 }} plays{% if artist.genres %} <span class="debug-chip">{{ artist.genres|join:", " }}</span>{% endif %}</li>
                                    {% endfor %}
                                </ul>
                            {% endif %}

                            {% if profile_snapshot.genres %}
                                <h4 style="margin-top: 16px; font-size: 0.95rem; color: rgba(255, 255, 255, 0.85);">Genre Buckets</h4>
                                {% for genre in profile_snapshot.genres %}
                                    <details class="debug-subdetails">
                                        <summary>{{ genre.genre|default:"(unknown genre)" }} · {{ genre.track_count|default:0 }} tracks</summary>
                                        <div class="debug-meta-row">
                                            <span class="debug-meta-label">Avg Popularity</span>
                                            <span class="debug-meta-value">{{ genre.avg_popularity|default:"—" }}</span>
                                        </div>
                                        <div class="debug-meta-row">
                                            <span class="debug-meta-label">Avg Year</span>
                                            <span class="debug-meta-value">{{ genre.avg_year|default:"—" }}</span>
                                        </div>
                                        {% if genre.tracks %}
                                            <ul class="debug-list">
                                                {% for track in genre.tracks %}
                                                    <li>{{ track.name|default:"(unknown)" }} — {{ track.artists|default:"—" }} (pop {{ track.popularity|default:0 }}, {{ track.year|default:"—" }})</li>
                                                {% endfor %}
                                            </ul>
                                        {% else %}
                                            <p class="debug-empty">No cached tracks recorded for this genre.</p>
                                        {% endif %}
                                    </details>
                                {% endfor %}
                            {% endif %}
                        </details>
                    {% endif %}

                    {% if debug_steps %}
                        <details class="debug-details">
                            <summary>Generation Log ({{ debug_steps|length }})</summary>
                            <ol class="debug-steps">
                                {% for step in debug_steps %}
                                    <li>{{ step }}</li>
                                {% endfor %}
                            </ol>
                        </details>
                    {% endif %}
                </section>
            {% endif %}
        </main>
    </div>

    <div class="remix-overlay" id="remix-overlay" data-total-steps="24">
        <div class="remix-modal">
            <div class="remix-loader-ring"></div>
            <h3>Remixing Your Playlist</h3>
            <div class="remix-progress">
                <div class="remix-progress-bar" id="remix-progress-bar"></div>
            </div>
            <div class="remix-progress-label" id="remix-progress-label">Preparing remix...</div>
        </div>
    </div>

    {% if playlist_stats %}
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js" integrity="sha384-Sse/HDqcypGpyTDpvZOJNnG0TT3feGQUkF9H+mnRvic+LjR+K1NhTt8f51KIQ3v3" crossorigin="anonymous"></script>
        <script src="{% static 'recommender_stats.js' %}"></script>
    {% endif %}

    <script>
        const trackList = document.getElementById('track-list');
        const saveButton = document.getElementById('save-playlist-button');
        const messageStack = document.getElementById('message-stack');
        const cacheKey = trackList ? trackList.dataset.cacheKey : null;
        const updateUrl = trackList ? trackList.dataset.updateUrl : null;
        const remixOverlay = document.getElementById('remix-overlay');
        const remixProgressBar = document.getElementById('remix-progress-bar');
        const remixProgressLabel = document.getElementById('remix-progress-label');
        const remixButton = document.getElementById('remix-button');
        const playlistForm = document.getElementById('playlist-save-form');

        let remixFrame = null;

        const resetRemixProgress = () => {
            if (remixFrame !== null) {
                cancelAnimationFrame(remixFrame);
                remixFrame = null;
            }
            remixProgressBar.style.width = '0%';
            remixProgressLabel.textContent = 'Preparing remix...';
        };

        const holdNearCompletion = (label) => {
            if (!remixOverlay.classList.contains('visible')) {
                resetRemixProgress();
                return;
            }
            const flicker = 94 + Math.random() * 2;
            remixProgressBar.style.width = `${flicker}%`;
            remixProgressLabel.textContent = `${label} (waiting on Spotify...)`;
            remixFrame = requestAnimationFrame(() => holdNearCompletion(label));
        };

        const startRemixProgress = () => {
            const totalSteps = Number(remixOverlay.dataset.totalSteps || 24);
            const phaseTimeline = [
                { label: 'Studying current mix', duration: 1200, target: 0.08 },
                { label: 'Spotlighting standout tracks', duration: 12500, target: 0.2 },
                { label: 'Hunting fresh vibes', duration: 58000, target: 0.72 },
                { label: 'Resolving Spotify matches', duration: 5500, target: 0.88 },
                { label: 'Balancing energy arcs', duration: 4200, target: 0.94 },
                { label: 'Sequencing transitions', duration: 2600, target: 0.97 },
            ];
            const finalLabel = 'Locking in remix order';
            const totalDuration = phaseTimeline.reduce((sum, phase) => sum + phase.duration, 0);
            const startTime = performance.now();

            const animate = () => {
                if (!remixOverlay.classList.contains('visible')) {
                    resetRemixProgress();
                    return;
                }

                const elapsed = performance.now() - startTime;
                const clampedElapsed = Math.min(elapsed, totalDuration);

                let accumulated = 0;
                let previousTarget = 0;
                let currentLabel = phaseTimeline[phaseTimeline.length - 1].label;
                let progressRatio = phaseTimeline[phaseTimeline.length - 1].target;

                for (const phase of phaseTimeline) {
                    const phaseStart = accumulated;
                    const phaseEnd = accumulated + phase.duration;
                    if (clampedElapsed <= phaseEnd) {
                        const localProgress = Math.min(
                            (clampedElapsed - phaseStart) / phase.duration,
                            1
                        );
                        progressRatio =
                            previousTarget + (phase.target - previousTarget) * (1 - Math.pow(1 - localProgress, 2));
                        currentLabel = phase.label;
                        break;
                    }
                    accumulated = phaseEnd;
                    previousTarget = phase.target;
                }

                const percentage = Math.max(1, Math.floor(progressRatio * 100));
                remixProgressBar.style.width = `${percentage}%`;

                const stepNumber = Math.max(
                    1,
                    Math.min(totalSteps, Math.round(progressRatio * totalSteps))
                );
                remixProgressLabel.textContent = `${currentLabel} (${stepNumber}/${totalSteps})`;

                if (clampedElapsed < totalDuration) {
                    remixFrame = requestAnimationFrame(animate);
                } else {
                    remixFrame = requestAnimationFrame(() => holdNearCompletion(finalLabel));
                }
            };

            animate();
        };

        remixButton.addEventListener('click', () => {
            if (remixButton.disabled) {
                return;
            }
            // Progress bar will be shown when modal is submitted
        });

        playlistForm.addEventListener('submit', (event) => {
            const submitter = event.submitter || document.activeElement;
            if (submitter !== remixButton) {
                remixOverlay.classList.remove('visible');
                resetRemixProgress();
            }
        });

        window.addEventListener('pagehide', () => {
            resetRemixProgress();
            remixOverlay.classList.remove('visible');
        });

        function formatDuration(ms) {
            const totalSeconds = Math.max(0, Math.floor(Number(ms) / 1000));
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }

        function refreshDurations() {
            if (!trackList) {
                return;
            }
            const durations = trackList.querySelectorAll('[data-duration-ms]');
            durations.forEach((node) => {
                const ms = Number(node.dataset.durationMs || 0);
                node.textContent = ms > 0 ? formatDuration(ms) : '--:--';
            });
        }

        function updateTrackPositions() {
            if (!trackList) {
                return;
            }
            const items = trackList.querySelectorAll('.track-item');
            items.forEach((item, index) => {
                item.dataset.position = String(index);
                const marker = item.querySelector('.track-position');
                if (marker) {
                    marker.textContent = `#${index + 1}`;
                }
            });
        }

        function setTrackCount(count) {
            const counter = document.getElementById('track-count');
            if (counter) {
                counter.textContent = String(count);
            }
            if (saveButton) {
                saveButton.disabled = count === 0;
            }
            const emptyState = document.getElementById('empty-state');
            if (count === 0) {
                if (!emptyState) {
                    const placeholder = document.createElement('li');
                    placeholder.id = 'empty-state';
                    placeholder.className = 'empty-state';
                    placeholder.textContent = 'No tracks available yet. Use Remix to generate a new set.';
                    trackList.appendChild(placeholder);
                }
            } else if (emptyState) {
                emptyState.remove();
            }
        }

        function pushMessage(kind, text) {
            if (!messageStack) {
                return;
            }
            const node = document.createElement('div');
            node.className = `message message-${kind}`;
            node.textContent = text;
            messageStack.appendChild(node);
        }

        function getCsrfToken() {
            const tokenInput = document.querySelector('input[name="csrfmiddlewaretoken"]');
            return tokenInput ? tokenInput.value : '';
        }

        if (trackList && cacheKey && updateUrl) {
            trackList.addEventListener('click', (event) => {
                const button = event.target.closest('.remove-track-button');
                if (!button) {
                    return;
                }
                const item = button.closest('.track-item');
                if (!item) {
                    return;
                }
                const trackId = item.dataset.trackId || '';
                const position = Number(item.dataset.position || 0);
                button.disabled = true;

                fetch(updateUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCsrfToken(),
                    },
                    credentials: 'same-origin',
                    body: JSON.stringify({
                        action: 'remove',
                        cache_key: cacheKey,
                        track_id: trackId,
                        position,
                    }),
                })
                    .then((response) => {
                        if (!response.ok) {
                            throw new Error('Request failed');
                        }
                        return response.json();
                    })
                    .then((payload) => {
                        if (payload.status !== 'ok') {
                            throw new Error(payload.error || 'Unable to update playlist.');
                        }
                        item.remove();
                        updateTrackPositions();
                        setTrackCount(payload.track_count || 0);
                        pushMessage('success', 'Track removed from the playlist.');
                    })
                    .catch((error) => {
                        button.disabled = false;
                        pushMessage('error', error.message || 'Failed to remove track. Try again.');
                    });
            });
        }

        refreshDurations();
        if (trackList) {
            setTrackCount(trackList.querySelectorAll('.track-item').length);
        }

        // Song search functionality
        const searchInput = document.getElementById('song-search-input');
        const searchTrigger = document.getElementById('song-search-trigger');
        const chipButtons = document.querySelectorAll('.chip-button[data-target-input]');

        if (chipButtons.length) {
            chipButtons.forEach((button) => {
                button.addEventListener('click', () => {
                    const targetId = button.dataset.targetInput;
                    const searchTerm = (button.dataset.searchTerm || button.textContent || '').trim();
                    if (!targetId || !searchTerm) {
                        return;
                    }
                    const input = document.getElementById(targetId);
                    if (!input) {
                        return;
                    }
                    input.value = searchTerm;
                    input.dispatchEvent(new Event('input', { bubbles: true }));
                    input.focus();
                });
            });
        }

        const searchResults = document.getElementById('search-results');
        if (searchInput && searchResults) {
            const searchUrl = searchInput.dataset.searchUrl;
            const addUrl = searchInput.dataset.addUrl;
            const cacheKey = searchInput.dataset.cacheKey;
            let searchTimeout = null;

            function hideSearchResults() {
                searchResults.style.display = 'none';
                searchResults.innerHTML = '';
            }

            function showSearchResults() {
                searchResults.style.display = 'block';
            }

            function createTrackElement(track) {
                const li = document.createElement('li');
                li.className = 'search-result-item';
                li.dataset.trackId = track.id;

                const trackDiv = document.createElement('div');
                trackDiv.className = 'search-result-track';

                if (track.album_image_url) {
                    const img = document.createElement('img');
                    img.src = track.album_image_url;
                    img.alt = `Album art for ${track.name}`;
                    img.className = 'search-result-art';
                    trackDiv.appendChild(img);
                } else {
                    const placeholder = document.createElement('div');
                    placeholder.className = 'search-result-art search-result-art--placeholder';
                    placeholder.textContent = track.name.charAt(0);
                    trackDiv.appendChild(placeholder);
                }

                const metaDiv = document.createElement('div');
                metaDiv.className = 'search-result-meta';

                const nameSpan = document.createElement('span');
                nameSpan.className = 'search-result-name';
                nameSpan.textContent = track.name;
                metaDiv.appendChild(nameSpan);

                const artistsSpan = document.createElement('span');
                artistsSpan.className = 'search-result-artists';
                artistsSpan.textContent = track.artists;
                metaDiv.appendChild(artistsSpan);

                trackDiv.appendChild(metaDiv);

                const addButton = document.createElement('button');
                addButton.className = 'search-result-add';
                addButton.textContent = '+ Add';
                addButton.type = 'button';
                trackDiv.appendChild(addButton);

                li.appendChild(trackDiv);
                return li;
            }

            function performSearch(query) {
                if (query.length < 2) {
                    hideSearchResults();
                    return;
                }

                fetch(`${searchUrl}?q=${encodeURIComponent(query)}`, {
                    method: 'GET',
                    credentials: 'same-origin',
                })
                    .then((response) => {
                        if (!response.ok) {
                            throw new Error('Search failed');
                        }
                        return response.json();
                    })
                    .then((data) => {
                        if (data.error) {
                            throw new Error(data.error);
                        }

                        searchResults.innerHTML = '';
                        if (data.results && data.results.length > 0) {
                            const ul = document.createElement('ul');
                            ul.className = 'search-result-list';
                            data.results.forEach((track) => {
                                const li = createTrackElement(track);
                                ul.appendChild(li);
                            });
                            searchResults.appendChild(ul);
                            showSearchResults();
                        } else {
                            const noResults = document.createElement('div');
                            noResults.className = 'search-no-results';
                            noResults.textContent = 'No songs found';
                            searchResults.appendChild(noResults);
                            showSearchResults();
                        }
                    })
                    .catch((error) => {
                        searchResults.innerHTML = '';
                        const errorDiv = document.createElement('div');
                        errorDiv.className = 'search-error';
                        errorDiv.textContent = error.message || 'Search failed. Try again.';
                        searchResults.appendChild(errorDiv);
                        showSearchResults();
                    });
            }

            searchInput.addEventListener('input', (event) => {
                const query = event.target.value.trim();
                if (searchTimeout) {
                    clearTimeout(searchTimeout);
                }
                searchTimeout = setTimeout(() => {
                    performSearch(query);
                }, 300);
            });

            searchInput.addEventListener('blur', () => {
                // Delay hiding to allow click on results
                setTimeout(() => {
                    hideSearchResults();
                }, 200);
            });

            searchInput.addEventListener('focus', () => {
                const query = searchInput.value.trim();
                if (query.length >= 2 && searchResults.innerHTML) {
                    showSearchResults();
                }
            });

            if (searchTrigger) {
                searchTrigger.addEventListener('click', () => {
                    const query = searchInput.value.trim();
                    performSearch(query);
                    searchInput.focus();
                });
            }

            searchResults.addEventListener('click', (event) => {
                const button = event.target.closest('.search-result-add');
                if (!button) {
                    return;
                }

                const item = button.closest('.search-result-item');
                if (!item) {
                    return;
                }

                const trackId = item.dataset.trackId;
                if (!trackId) {
                    return;
                }

                button.disabled = true;
                button.textContent = 'Adding...';

                fetch(addUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCsrfToken(),
                    },
                    credentials: 'same-origin',
                    body: JSON.stringify({
                        cache_key: cacheKey,
                        track_id: trackId,
                    }),
                })
                    .then((response) => {
                        if (!response.ok) {
                            return response.json().then(data => {
                                throw new Error(data.error || 'Failed to add track');
                            });
                        }
                        return response.json();
                    })
                    .then((data) => {
                        if (data.status !== 'ok') {
                            throw new Error(data.error || 'Failed to add track');
                        }

                        // Add track to the track list
                        if (trackList && data.track) {
                            const existingCount = trackList.querySelectorAll('.track-item').length;
                            const trackItem = document.createElement('li');
                            trackItem.className = 'track-item';
                            trackItem.dataset.trackId = data.track.id;
                            trackItem.dataset.position = String(existingCount);

                            const track = data.track;
                            const durationFormatted = formatDuration(track.duration_ms || 0);
                            const fallbackInitial = (track.name || '?').charAt(0);

                            trackItem.innerHTML = `
                                <div class="track-position">#${existingCount + 1}</div>
                                <div class="track-artwork">
                                    ${track.album_image_url
                                        ? `<img src="${track.album_image_url}" alt="Album artwork for ${track.name}">`
                                        : fallbackInitial}
                                </div>
                                <div class="track-info">
                                    <span class="track-name">${track.name}</span>
                                    <span class="track-artist">${track.artists}</span>
                                    ${track.album_name ? `<span class="track-album">${track.album_name}</span>` : ''}
                                </div>
                                <div class="track-meta">
                                    <span class="track-duration" data-duration-ms="${track.duration_ms || 0}">${durationFormatted}</span>
                                    <button type="button" class="remove-track-button">Remove</button>
                                </div>
                            `;

                            trackList.appendChild(trackItem);
                            updateTrackPositions();
                            setTrackCount(data.track_count || trackList.querySelectorAll('.track-item').length);
                        }

                        pushMessage('success', `Added "${data.track.name}" to playlist`);
                        button.textContent = 'Added!';
                        searchInput.value = '';
                        hideSearchResults();

                        setTimeout(() => {
                            button.disabled = false;
                            button.textContent = '+ Add';
                        }, 2000);
                    })
                    .catch((error) => {
                        button.disabled = false;
                        button.textContent = '+ Add';
                        pushMessage('error', error.message || 'Failed to add track. Try again.');
                    });
            });

            // Close search results when clicking outside
            document.addEventListener('click', (event) => {
                if (!searchInput.contains(event.target) && !searchResults.contains(event.target)) {
                    hideSearchResults();
                }
            });
        }

        const genreToggle = document.querySelector('.genre-toggle');
        const remainingGenreList = document.querySelector('[data-genre-list="remaining"]');
        if (genreToggle && remainingGenreList) {
            genreToggle.addEventListener('click', () => {
                const expanded = genreToggle.getAttribute('aria-expanded') === 'true';
                genreToggle.setAttribute('aria-expanded', String(!expanded));
                remainingGenreList.classList.toggle('genre-legend--hidden', expanded);
                genreToggle.textContent = expanded ? 'Show All Genres' : 'Hide Genres';
            });
        }

        // Remix Modal Handler
        document.addEventListener('DOMContentLoaded', function() {
            // const remixButton = document.getElementById('remix-button');
            // const remixOverlay = document.getElementById('remix-overlay');
            const modalOverlay = document.getElementById('remix-modal-overlay');
            const modalClose = document.getElementById('remix-modal-close');
            const modalCancel = document.getElementById('remix-modal-cancel');
            const modalSubmit = document.getElementById('remix-modal-submit');
            const promptInput = document.getElementById('remix-prompt-input');
            // const targetCountInput = document.getElementById('remix-target-count-input');
            const trackCount = document.getElementById('track-count');

            // Initialize target count with current playlist size
            // if (trackCount) {
            //     targetCountInput.value = trackCount.textContent;
            // }


            // Open modal when remix button is clicked
            remixButton.addEventListener('click', function(e) {
                e.preventDefault();
                modalOverlay.classList.remove('hidden');
                promptInput.focus();
            });

            // Close modal functions
            function closeModal() {
                modalOverlay.classList.add('hidden');
            }

            // Close button
            modalClose.addEventListener('click', closeModal);

            // Cancel button
            modalCancel.addEventListener('click', closeModal);

            // Close when clicking outside the modal
            modalOverlay.addEventListener('click', function(e) {
                if (e.target === modalOverlay) {
                    closeModal();
                }
            });

            // Submit remix form
            modalSubmit.addEventListener('click', function(e) {
                e.preventDefault();

                const prompt = promptInput.value.trim();
                // Derive target count from current playlist size
                const targetCount = trackCount ? trackCount.textContent : '50';


                // Validation
                if (!prompt) {
                    alert('Please enter a remix prompt');
                    return;
                }


                // if (!targetCount || parseInt(targetCount) < 1) {
                //     alert('Please enter a valid number of songs');
                //     return;
                // }


                // Show progress bar overlay and start animation
                remixOverlay.classList.add('visible');
                resetRemixProgress();
                startRemixProgress();

                // Create and submit form with POST data
                const form = document.createElement('form');
                form.method = 'POST';
                form.action = window.location.href; // Post to same URL

                // Add CSRF token if it exists
                const csrfToken = document.querySelector('[name="csrfmiddlewaretoken"]');
                if (csrfToken) {
                    const csrfInput = document.createElement('input');
                    csrfInput.type = 'hidden';
                    csrfInput.name = 'csrfmiddlewaretoken';
                    csrfInput.value = csrfToken.value;
                    form.appendChild(csrfInput);
                }

                // Add prompt field
                const promptField = document.createElement('input');
                promptField.type = 'hidden';
                promptField.name = 'prompt';
                promptField.value = prompt;
                form.appendChild(promptField);

                // Add target_count field
                const targetCountField = document.createElement('input');
                targetCountField.type = 'hidden';
                targetCountField.name = 'target_count';
                targetCountField.value = targetCount;
                form.appendChild(targetCountField);

                // Submit the form
                document.body.appendChild(form);
                form.submit();
            });

            // Allow Enter key to submit from inputs
            promptInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && e.ctrlKey) {
                    modalSubmit.click();
                }
            });


            // targetCountInput.addEventListener('keypress', function(e) {
            //     if (e.key === 'Enter') {
            //         modalSubmit.click();
            //     }
            // });
        });
    </script>
    <!-- Remix Modal Overlay -->
    <div id="remix-modal-overlay" class="remix-modal-overlay hidden">
        <div class="remix-modal">
            <div class="remix-modal__header">
                <h2>Remix Your Playlist</h2>
                <button type="button" class="remix-modal__close" id="remix-modal-close" aria-label="Close modal">×</button>
            </div>
            <div class="remix-modal__body">
                <div class="remix-form-group">
                    <label for="remix-prompt-input" class="remix-form-label">Remix Prompt</label>
                    <textarea
                        id="remix-prompt-input"
                        class="remix-form-input remix-form-textarea"
                        placeholder="Describe the vibe, genre, or direction you want for your remix..."
                        rows="3"></textarea>
                </div>
                <!-- Target count input commented out while maintaining functionality -->
                <!-- <div class="remix-form-group">
                    <label for="remix-target-count-input" class="remix-form-label">Number of Songs</label>
                    <input
                        type="number"
                        id="remix-target-count-input"
                        class="remix-form-input"
                        min="1"
                        max="500"
                        placeholder="Number of songs">
                </div> -->
            </div>
            <div class="remix-modal__footer">
                <button type="button" class="btn btn-outline" id="remix-modal-cancel">Cancel</button>
                <button type="button" class="btn btn-primary" id="remix-modal-submit">Start Remix</button>
            </div>
        </div>
    </div>

</body>
</html>
